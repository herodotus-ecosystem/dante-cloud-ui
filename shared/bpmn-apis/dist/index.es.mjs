import{lodash as t,Service as e,moment as s,ContentTypeEnum as r,HttpConfig as n}from"@herodotus/core";import{Axios as i,ContentTypeEnum as a,HttpConfig as c,Service as g,lodash as o,moment as d}from"@herodotus/core";class PathParamBuilder{address;action="";constructor(t){this.address=t}getWellFormedAddress(){let e=this.address;return t.endsWith(e,"/")?t.trimEnd(e,"/"):e}addAction(t){this.action=t}appendAction(t){return this.action?t+"/"+this.action:t}}class UnionPathParamBuilder extends PathParamBuilder{id="";key="";tenantId="";constructor(t){super(t)}setAction(t){return this.addAction(t),this}withParam(t){return this.id=t.id,this.key=t.key,this.tenantId=t.tenantId,this}build(){let t=this.getWellFormedAddress();return this.id?t+="/"+this.id:(this.key&&(t+="/key/"+this.key),this.tenantId&&(t+="/tenant-id/"+this.tenantId)),this.appendAction(t)}}class RelationPathParamBuilder extends PathParamBuilder{id="";relationId="";constructor(t){super(t)}withParam(t){return this.id=t.id,this.relationId=t.relationId,this.addAction(t.action),this}build(){let t=this.getWellFormedAddress();return t+="/"+this.id,t=this.appendAction(t),t+="/"+this.relationId,t}}class BpmnService extends e{getCountAddress(){return this.getBaseAddress()+"/count"}createAddressByParam(t,e=""){let s=new UnionPathParamBuilder(this.getBaseAddress());return e?s.withParam(t).setAction(e).build():s.withParam(t).build()}createAddressByRelation(t,e,s){return new RelationPathParamBuilder(this.getBaseAddress()).withParam({id:t,relationId:e,action:s}).build()}createAddressById(t,e=""){return this.createAddressByParam({id:t},e)}delete(e,s={}){return t.isEmpty(s)?this.getConfig().getHttp().delete(this.createAddressById(e)):this.getConfig().getHttp().deleteWithParams(this.createAddressById(e),s)}}class BpmnQueryByGetService extends BpmnService{getCount(t={}){return new Promise((e,s)=>{this.getConfig().getHttp().get(this.getCountAddress(),t).then(t=>{if(t){e(t.count)}}).catch(t=>{s(t)})})}getList(t,e,s={}){const r=Object.assign(s,{sortBy:t.sortBy,sortOrder:t.sortOrder,firstResult:(t.pageNumber-1)*t.pageSize,maxResults:t.pageSize});return new Promise((s,n)=>{this.getConfig().getHttp().get(this.getBaseAddress(),r).then(r=>{const n={content:r,totalPages:e?(e+t.pageSize-1)/t.pageSize:e,totalElements:String(e)};s(n)}).catch(t=>{n(t)})})}getByPage(t,e={}){return new Promise((s,r)=>{this.getCount(e).then(r=>{this.getList(t,r,e).then(t=>{s(t)})}).catch(t=>{r(t)})})}getAll(t,e={}){return new Promise((s,r)=>{this.getCount(e).then(r=>{const n=Object.assign(e,{sortBy:t.sortBy,sortOrder:t.sortOrder,firstResult:0,maxResults:r});this.getConfig().getHttp().get(this.getBaseAddress(),n).then(t=>{s(t)})}).catch(t=>{r(t)})})}}class BpmnQueryService extends BpmnQueryByGetService{get(t){return this.getConfig().getHttp().get(this.createAddressById(t))}}class BpmnQueryByPostService extends BpmnQueryService{getPostCount(t={}){return new Promise((e,s)=>{this.getConfig().getHttp().get(this.getCountAddress(),t).then(t=>{if(t){e(t.count)}}).catch(t=>{s(t)})})}getPostList(e,s,r=[],n={}){const i={firstResult:(e.pageNumber-1)*e.pageSize,maxResults:e.pageSize};let a={};return t.isEmpty(r)||(a=Object.assign(n,{sorting:r})),new Promise((t,r)=>{this.getConfig().getHttp().postWithParams(this.getBaseAddress(),i,a).then(r=>{const n={content:r,totalPages:s?(s+e.pageSize-1)/e.pageSize:s,totalElements:String(s)};t(n)}).catch(t=>{r(t)})})}getPostByPage(t,e=[],s={}){return new Promise((r,n)=>{this.getPostCount(s).then(n=>{this.getPostList(t,n,e,s).then(t=>{r(t)})}).catch(t=>{n(t)})})}}class BaseBpmnService extends BpmnQueryByPostService{}class DeploymentService extends BpmnQueryService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new DeploymentService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/deployment"}getCreateAddress(){return this.getBaseAddress()+"/create"}getDuplicateFiltering(t){return t.deployChangedOnly?"true":t.enableDuplicateFiltering?String(t.enableDuplicateFiltering):"false"}create(t){let e=new FormData;e.append("deployment-name",t.deploymentName),e.append("deploy-changed-only",t.deployChangedOnly?"true":"false"),e.append("enable-duplicate-filtering",this.getDuplicateFiltering(t)),e.append("deployment-source",t.deploymentSource?t.deploymentSource:"Dante Cloud UI");const n=t.deploymentActivationTime?t.deploymentActivationTime:/* @__PURE__ */new Date;e.append("deployment-activation-time",s(n).utc().format()),t.tenantId&&e.append("tenant-id",t.tenantId);let i=new Blob([t.resource],{type:"application/octet-stream"});return e.append("data",i,t.deploymentName),this.getConfig().getHttp().post(this.getCreateAddress(),e,{contentType:r.MULTI_PART})}redeploy(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"redeploy"),e)}getResources(t){return this.getConfig().getHttp().get(this.createAddressById(t,"resources"))}getResource(t,e){return this.getConfig().getHttp().get(this.createAddressByRelation(t,e,"resources"))}getBinaryResource(t,e){const s=this.createAddressByRelation(t,e,"resources")+"/data";return this.getConfig().getHttp().get(s)}getRegisteredDeployments(){const t=this.getBaseAddress()+"/registered";return this.getConfig().getHttp().get(t)}}class ProcessDefinitionService extends BpmnQueryService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new ProcessDefinitionService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/process-definition"}getActivityInstanceStatistics(t,e){return this.getConfig().getHttp().get(this.createAddressByParam(t,"statistics"),e)}getStaticCalledProcessDefinitions(t){return this.getConfig().getHttp().get(this.createAddressById(t,"static-called-process-definitions"))}getDiagram(t){return this.getConfig().getHttp().get(this.createAddressByParam(t,"diagram"))}getStartFormVariables(t,e){return this.getConfig().getHttp().get(this.createAddressByParam(t,"form-variables"),e)}getRenderedFormStartForm(t){return this.getConfig().getHttp().get(this.createAddressByParam(t,"rendered-form"))}getStartFormKey(t){return this.getConfig().getHttp().get(this.createAddressByParam(t,"startForm"))}getProcessInstanceStatistics(t){const e=this.getBaseAddress()+"/statistics";return this.getConfig().getHttp().get(e,t)}getXml(t){return this.getConfig().getHttp().get(this.createAddressByParam(t,"xml"))}getByPathParams(t){return this.getConfig().getHttp().get(this.createAddressByParam(t))}start(t,e){return this.getConfig().getHttp().post(this.createAddressByParam(t,"start"),e)}submitStartForm(t,e){return this.getConfig().getHttp().post(this.createAddressByParam(t,"submit-form"),e)}activateOrSuspendById(t,e){return this.getConfig().getHttp().put(this.createAddressByParam(t,"suspended"),e)}activateOrSuspendByKey(t){const e=this.getBaseAddress()+"/suspended";return this.getConfig().getHttp().put(e,t)}updateHistoryTimeToLive(t,e){return this.getConfig().getHttp().put(this.createAddressByParam(t,"history-time-to-live"),e)}deleteByKey(t,e="",s){return this.getConfig().getHttp().deleteWithParams(this.createAddressByParam({key:t,tenantId:e},"delete"),s)}getDeployedStartForm(t){return this.getConfig().getHttp().get(this.createAddressByParam(t,"deployed-start-form"))}restartProcessInstance(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"restart"),e)}restartAsync(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"restart-async"),e)}}class ProcessInstanceService extends BaseBpmnService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new ProcessInstanceService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/process-instance"}getActivityInstance(t){return this.getConfig().getHttp().get(this.createAddressById(t,"activity-instances"))}modify(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"modification"),e)}modifyAsync(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"modification-async"),e)}deleteAsync(t){const e=this.getBaseAddress()+"/delete";return this.getConfig().getHttp().post(e,t)}deleteAsyncHistoricQueryBased(t){const e=this.getBaseAddress()+"/delete-historic-query-based";return this.getConfig().getHttp().post(e,t)}setJobRetriesAsync(t){const e=this.getBaseAddress()+"/job-retries";return this.getConfig().getHttp().post(e,t)}setJobRetriesAsyncHistoricQueryBased(t){const e=this.getBaseAddress()+"/job-retries-historic-query-based";return this.getConfig().getHttp().post(e,t)}setVariablesAsync(t){const e=this.getBaseAddress()+"variables-async";return this.getConfig().getHttp().post(e,t)}correlateMessageAsync(t){const e=this.getBaseAddress()+"message-async";return this.getConfig().getHttp().post(e,t)}activateOrSuspendById(t,e){return this.getConfig().getHttp().put(this.createAddressById(t,"suspended"),e)}activateOrSuspendByProcessDefinitionId(t){const e=this.getBaseAddress()+"/suspended";return this.getConfig().getHttp().put(e,t)}activateOrSuspendByProcessDefinitionKey(t){const e=this.getBaseAddress()+"/suspended";return this.getConfig().getHttp().put(e,t)}activateOrSuspendInGroup(t){const e=this.getBaseAddress()+"suspended-async";return this.getConfig().getHttp().post(e,t)}activateOrSuspendInBatch(t){const e=this.getBaseAddress()+"suspended-async";return this.getConfig().getHttp().post(e,t)}}class TaskService extends BaseBpmnService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new TaskService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/task"}getCreateAddress(){return this.getBaseAddress()+"/create"}getFormKey(t){return this.getConfig().getHttp().get(this.createAddressById(t,"form"))}claim(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"claim"),e)}unclaim(t){return this.getConfig().getHttp().post(this.createAddressById(t,"unclaim"),{})}complete(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"complete"),e)}submitForm(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"submit-form"),e)}resolve(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"resolve"),e)}setAssignee(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"assignee"),e)}delegate(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"delegate"),e)}getDeployedForm(t){return this.getConfig().getHttp().get(this.createAddressById(t,"deployed-form"))}getRenderedForm(t){return this.getConfig().getHttp().get(this.createAddressById(t,"rendered-form"))}getTaskFormVariables(t,e){return this.getConfig().getHttp().get(this.createAddressById(t,"form-variables"),e)}create(t){return this.getConfig().getHttp().post(this.getCreateAddress(),t)}update(t,e){return this.getConfig().getHttp().put(this.createAddressById(t),e)}handleBpmnError(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"bpmnError"),e)}handleBpmnEscalation(t,e){return this.getConfig().getHttp().post(this.createAddressById(t,"bpmnEscalation"),e)}}class HistoryActivityInstanceService extends BpmnQueryByPostService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new HistoryActivityInstanceService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/history/activity-instance"}}class HistoryProcessInstanceService extends BpmnQueryByPostService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new HistoryProcessInstanceService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/history/process-instance"}}class HistoryTaskService extends BpmnQueryByPostService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new HistoryTaskService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/history/task"}}class GroupService extends BaseBpmnService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new GroupService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/group"}getCreateAddress(){return this.getBaseAddress()+"/create"}create(t){return this.getConfig().getHttp().post(this.getCreateAddress(),t)}update(t,e){return this.getConfig().getHttp().put(this.createAddressById(t),e)}}class GroupMemberService extends BpmnService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new GroupMemberService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/group"}getRelationAddress(t,e=""){return this.createAddressByRelation(t,e,"members")}create(t,e){return this.getConfig().getHttp().put(this.getRelationAddress(t,e),"")}deleteByRelation(t,e){return this.getConfig().getHttp().delete(this.getRelationAddress(t,e))}}class TenantService extends BpmnQueryService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new TenantService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/tenant"}getCreateAddress(){return this.getBaseAddress()+"/create"}createTenant(t){return this.getConfig().getHttp().post(this.getCreateAddress(),t)}update(t,e){return this.getConfig().getHttp().put(this.createAddressById(t),e)}}class TenantUserService extends BpmnService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new TenantUserService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/tenant"}getRelationAddress(t,e=""){return this.createAddressByRelation(t,e,"user-members")}create(t,e){return this.getConfig().getHttp().put(this.getRelationAddress(t,e),"")}deleteByRelation(t,e){return this.getConfig().getHttp().delete(this.getRelationAddress(t,e))}}class TenantGroupService extends BpmnService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new TenantGroupService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/tenant"}getRelationAddress(t,e=""){return this.createAddressByRelation(t,e,"group-members")}create(t,e){return this.getConfig().getHttp().put(this.getRelationAddress(t,e),"")}deleteByRelation(t,e){return this.getConfig().getHttp().delete(this.getRelationAddress(t,e))}}class UserService extends BpmnQueryByGetService{static instance;constructor(t){super(t)}static getInstance(t){return null==this.instance&&(this.instance=new UserService(t)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/user"}getCreateAddress(){return this.getBaseAddress()+"/create"}}class BpmnApiResources{static instance;config={};constructor(t){this.config=t}static getInstance(t){return null==this.instance&&(this.instance=new BpmnApiResources(t)),this.instance}getConfig(){return this.config}deployment(){return DeploymentService.getInstance(this.config)}processDefinition(){return ProcessDefinitionService.getInstance(this.config)}processInstance(){return ProcessInstanceService.getInstance(this.config)}task(){return TaskService.getInstance(this.config)}historyActivityInstance(){return HistoryActivityInstanceService.getInstance(this.config)}historyProcessInstance(){return HistoryProcessInstanceService.getInstance(this.config)}historyTask(){return HistoryTaskService.getInstance(this.config)}group(){return GroupService.getInstance(this.config)}groupMember(){return GroupMemberService.getInstance(this.config)}tenant(){return TenantService.getInstance(this.config)}tenantUser(){return TenantUserService.getInstance(this.config)}tenantGroup(){return TenantGroupService.getInstance(this.config)}user(){return UserService.getInstance(this.config)}}const u=(t,e,s,r)=>{const i=new n(t,e,s,r);return BpmnApiResources.getInstance(i)};export{i as Axios,BaseBpmnService,BpmnQueryByGetService,BpmnQueryByPostService,BpmnQueryService,BpmnService,a as ContentTypeEnum,DeploymentService,GroupMemberService,GroupService,HistoryActivityInstanceService,HistoryProcessInstanceService,HistoryTaskService,c as HttpConfig,ProcessDefinitionService,ProcessInstanceService,RelationPathParamBuilder,g as Service,TaskService,TenantGroupService,TenantService,TenantUserService,UnionPathParamBuilder,UserService,u as createBpmnApi,o as lodash,d as moment};
