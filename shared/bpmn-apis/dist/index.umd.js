!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@herodotus/core")):"function"==typeof define&&define.amd?define(["exports","@herodotus/core"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["@herodotus/bpmn-apis"]={},e.HerodotusCore)}(this,function(e,t){"use strict";class PathParamBuilder{address;action="";constructor(e){this.address=e}getWellFormedAddress(){let e=this.address;return t.lodash.endsWith(e,"/")?t.lodash.trimEnd(e,"/"):e}addAction(e){this.action=e}appendAction(e){return this.action?e+"/"+this.action:e}}class UnionPathParamBuilder extends PathParamBuilder{id="";key="";tenantId="";constructor(e){super(e)}setAction(e){return this.addAction(e),this}withParam(e){return this.id=e.id,this.key=e.key,this.tenantId=e.tenantId,this}build(){let e=this.getWellFormedAddress();return this.id?e+="/"+this.id:(this.key&&(e+="/key/"+this.key),this.tenantId&&(e+="/tenant-id/"+this.tenantId)),this.appendAction(e)}}class RelationPathParamBuilder extends PathParamBuilder{id="";relationId="";constructor(e){super(e)}withParam(e){return this.id=e.id,this.relationId=e.relationId,this.addAction(e.action),this}build(){let e=this.getWellFormedAddress();return e+="/"+this.id,e=this.appendAction(e),e+="/"+this.relationId,e}}class BpmnService extends t.Service{getCountAddress(){return this.getBaseAddress()+"/count"}createAddressByParam(e,t=""){let s=new UnionPathParamBuilder(this.getBaseAddress());return t?s.withParam(e).setAction(t).build():s.withParam(e).build()}createAddressByRelation(e,t,s){return new RelationPathParamBuilder(this.getBaseAddress()).withParam({id:e,relationId:t,action:s}).build()}createAddressById(e,t=""){return this.createAddressByParam({id:e},t)}delete(e,s={}){return t.lodash.isEmpty(s)?this.getConfig().getHttp().delete(this.createAddressById(e)):this.getConfig().getHttp().deleteWithParams(this.createAddressById(e),s)}}class BpmnQueryByGetService extends BpmnService{getCount(e={}){return new Promise((t,s)=>{this.getConfig().getHttp().get(this.getCountAddress(),e).then(e=>{if(e){t(e.count)}}).catch(e=>{s(e)})})}getList(e,t,s={}){const r=Object.assign(s,{sortBy:e.sortBy,sortOrder:e.sortOrder,firstResult:(e.pageNumber-1)*e.pageSize,maxResults:e.pageSize});return new Promise((s,n)=>{this.getConfig().getHttp().get(this.getBaseAddress(),r).then(r=>{const n={content:r,totalPages:t?(t+e.pageSize-1)/e.pageSize:t,totalElements:String(t)};s(n)}).catch(e=>{n(e)})})}getByPage(e,t={}){return new Promise((s,r)=>{this.getCount(t).then(r=>{this.getList(e,r,t).then(e=>{s(e)})}).catch(e=>{r(e)})})}getAll(e,t={}){return new Promise((s,r)=>{this.getCount(t).then(r=>{const n=Object.assign(t,{sortBy:e.sortBy,sortOrder:e.sortOrder,firstResult:0,maxResults:r});this.getConfig().getHttp().get(this.getBaseAddress(),n).then(e=>{s(e)})}).catch(e=>{r(e)})})}}class BpmnQueryService extends BpmnQueryByGetService{get(e){return this.getConfig().getHttp().get(this.createAddressById(e))}}class BpmnQueryByPostService extends BpmnQueryService{getPostCount(e={}){return new Promise((t,s)=>{this.getConfig().getHttp().get(this.getCountAddress(),e).then(e=>{if(e){t(e.count)}}).catch(e=>{s(e)})})}getPostList(e,s,r=[],n={}){const i={firstResult:(e.pageNumber-1)*e.pageSize,maxResults:e.pageSize};let a={};return t.lodash.isEmpty(r)||(a=Object.assign(n,{sorting:r})),new Promise((t,r)=>{this.getConfig().getHttp().postWithParams(this.getBaseAddress(),i,a).then(r=>{const n={content:r,totalPages:s?(s+e.pageSize-1)/e.pageSize:s,totalElements:String(s)};t(n)}).catch(e=>{r(e)})})}getPostByPage(e,t=[],s={}){return new Promise((r,n)=>{this.getPostCount(s).then(n=>{this.getPostList(e,n,t,s).then(e=>{r(e)})}).catch(e=>{n(e)})})}}class BaseBpmnService extends BpmnQueryByPostService{}class DeploymentService extends BpmnQueryService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new DeploymentService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/deployment"}getCreateAddress(){return this.getBaseAddress()+"/create"}getDuplicateFiltering(e){return e.deployChangedOnly?"true":e.enableDuplicateFiltering?String(e.enableDuplicateFiltering):"false"}create(e){let s=new FormData;s.append("deployment-name",e.deploymentName),s.append("deploy-changed-only",e.deployChangedOnly?"true":"false"),s.append("enable-duplicate-filtering",this.getDuplicateFiltering(e)),s.append("deployment-source",e.deploymentSource?e.deploymentSource:"Dante Cloud UI");const r=e.deploymentActivationTime?e.deploymentActivationTime:new Date;s.append("deployment-activation-time",t.moment(r).utc().format()),e.tenantId&&s.append("tenant-id",e.tenantId);let n=new Blob([e.resource],{type:"application/octet-stream"});return s.append("data",n,e.deploymentName),this.getConfig().getHttp().post(this.getCreateAddress(),s,{contentType:t.ContentTypeEnum.MULTI_PART})}redeploy(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"redeploy"),t)}getResources(e){return this.getConfig().getHttp().get(this.createAddressById(e,"resources"))}getResource(e,t){return this.getConfig().getHttp().get(this.createAddressByRelation(e,t,"resources"))}getBinaryResource(e,t){const s=this.createAddressByRelation(e,t,"resources")+"/data";return this.getConfig().getHttp().get(s)}getRegisteredDeployments(){const e=this.getBaseAddress()+"/registered";return this.getConfig().getHttp().get(e)}}class ProcessDefinitionService extends BpmnQueryService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new ProcessDefinitionService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/process-definition"}getActivityInstanceStatistics(e,t){return this.getConfig().getHttp().get(this.createAddressByParam(e,"statistics"),t)}getStaticCalledProcessDefinitions(e){return this.getConfig().getHttp().get(this.createAddressById(e,"static-called-process-definitions"))}getDiagram(e){return this.getConfig().getHttp().get(this.createAddressByParam(e,"diagram"))}getStartFormVariables(e,t){return this.getConfig().getHttp().get(this.createAddressByParam(e,"form-variables"),t)}getRenderedFormStartForm(e){return this.getConfig().getHttp().get(this.createAddressByParam(e,"rendered-form"))}getStartFormKey(e){return this.getConfig().getHttp().get(this.createAddressByParam(e,"startForm"))}getProcessInstanceStatistics(e){const t=this.getBaseAddress()+"/statistics";return this.getConfig().getHttp().get(t,e)}getXml(e){return this.getConfig().getHttp().get(this.createAddressByParam(e,"xml"))}getByPathParams(e){return this.getConfig().getHttp().get(this.createAddressByParam(e))}start(e,t){return this.getConfig().getHttp().post(this.createAddressByParam(e,"start"),t)}submitStartForm(e,t){return this.getConfig().getHttp().post(this.createAddressByParam(e,"submit-form"),t)}activateOrSuspendById(e,t){return this.getConfig().getHttp().put(this.createAddressByParam(e,"suspended"),t)}activateOrSuspendByKey(e){const t=this.getBaseAddress()+"/suspended";return this.getConfig().getHttp().put(t,e)}updateHistoryTimeToLive(e,t){return this.getConfig().getHttp().put(this.createAddressByParam(e,"history-time-to-live"),t)}deleteByKey(e,t="",s){return this.getConfig().getHttp().deleteWithParams(this.createAddressByParam({key:e,tenantId:t},"delete"),s)}getDeployedStartForm(e){return this.getConfig().getHttp().get(this.createAddressByParam(e,"deployed-start-form"))}restartProcessInstance(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"restart"),t)}restartAsync(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"restart-async"),t)}}class ProcessInstanceService extends BaseBpmnService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new ProcessInstanceService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/process-instance"}getActivityInstance(e){return this.getConfig().getHttp().get(this.createAddressById(e,"activity-instances"))}modify(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"modification"),t)}modifyAsync(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"modification-async"),t)}deleteAsync(e){const t=this.getBaseAddress()+"/delete";return this.getConfig().getHttp().post(t,e)}deleteAsyncHistoricQueryBased(e){const t=this.getBaseAddress()+"/delete-historic-query-based";return this.getConfig().getHttp().post(t,e)}setJobRetriesAsync(e){const t=this.getBaseAddress()+"/job-retries";return this.getConfig().getHttp().post(t,e)}setJobRetriesAsyncHistoricQueryBased(e){const t=this.getBaseAddress()+"/job-retries-historic-query-based";return this.getConfig().getHttp().post(t,e)}setVariablesAsync(e){const t=this.getBaseAddress()+"variables-async";return this.getConfig().getHttp().post(t,e)}correlateMessageAsync(e){const t=this.getBaseAddress()+"message-async";return this.getConfig().getHttp().post(t,e)}activateOrSuspendById(e,t){return this.getConfig().getHttp().put(this.createAddressById(e,"suspended"),t)}activateOrSuspendByProcessDefinitionId(e){const t=this.getBaseAddress()+"/suspended";return this.getConfig().getHttp().put(t,e)}activateOrSuspendByProcessDefinitionKey(e){const t=this.getBaseAddress()+"/suspended";return this.getConfig().getHttp().put(t,e)}activateOrSuspendInGroup(e){const t=this.getBaseAddress()+"suspended-async";return this.getConfig().getHttp().post(t,e)}activateOrSuspendInBatch(e){const t=this.getBaseAddress()+"suspended-async";return this.getConfig().getHttp().post(t,e)}}class TaskService extends BaseBpmnService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new TaskService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/task"}getCreateAddress(){return this.getBaseAddress()+"/create"}getFormKey(e){return this.getConfig().getHttp().get(this.createAddressById(e,"form"))}claim(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"claim"),t)}unclaim(e){return this.getConfig().getHttp().post(this.createAddressById(e,"unclaim"),{})}complete(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"complete"),t)}submitForm(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"submit-form"),t)}resolve(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"resolve"),t)}setAssignee(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"assignee"),t)}delegate(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"delegate"),t)}getDeployedForm(e){return this.getConfig().getHttp().get(this.createAddressById(e,"deployed-form"))}getRenderedForm(e){return this.getConfig().getHttp().get(this.createAddressById(e,"rendered-form"))}getTaskFormVariables(e,t){return this.getConfig().getHttp().get(this.createAddressById(e,"form-variables"),t)}create(e){return this.getConfig().getHttp().post(this.getCreateAddress(),e)}update(e,t){return this.getConfig().getHttp().put(this.createAddressById(e),t)}handleBpmnError(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"bpmnError"),t)}handleBpmnEscalation(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"bpmnEscalation"),t)}}class HistoryActivityInstanceService extends BpmnQueryByPostService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new HistoryActivityInstanceService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/history/activity-instance"}}class HistoryProcessInstanceService extends BpmnQueryByPostService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new HistoryProcessInstanceService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/history/process-instance"}}class HistoryTaskService extends BpmnQueryByPostService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new HistoryTaskService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/history/task"}}class GroupService extends BaseBpmnService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new GroupService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/group"}getCreateAddress(){return this.getBaseAddress()+"/create"}create(e){return this.getConfig().getHttp().post(this.getCreateAddress(),e)}update(e,t){return this.getConfig().getHttp().put(this.createAddressById(e),t)}}class GroupMemberService extends BpmnService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new GroupMemberService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/group"}getRelationAddress(e,t=""){return this.createAddressByRelation(e,t,"members")}create(e,t){return this.getConfig().getHttp().put(this.getRelationAddress(e,t),"")}deleteByRelation(e,t){return this.getConfig().getHttp().delete(this.getRelationAddress(e,t))}}class TenantService extends BpmnQueryService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new TenantService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/tenant"}getCreateAddress(){return this.getBaseAddress()+"/create"}createTenant(e){return this.getConfig().getHttp().post(this.getCreateAddress(),e)}update(e,t){return this.getConfig().getHttp().put(this.createAddressById(e),t)}}class TenantUserService extends BpmnService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new TenantUserService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/tenant"}getRelationAddress(e,t=""){return this.createAddressByRelation(e,t,"user-members")}create(e,t){return this.getConfig().getHttp().put(this.getRelationAddress(e,t),"")}deleteByRelation(e,t){return this.getConfig().getHttp().delete(this.getRelationAddress(e,t))}}class TenantGroupService extends BpmnService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new TenantGroupService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/tenant"}getRelationAddress(e,t=""){return this.createAddressByRelation(e,t,"group-members")}create(e,t){return this.getConfig().getHttp().put(this.getRelationAddress(e,t),"")}deleteByRelation(e,t){return this.getConfig().getHttp().delete(this.getRelationAddress(e,t))}}class UserService extends BpmnQueryByGetService{static instance;constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new UserService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/user"}getCreateAddress(){return this.getBaseAddress()+"/create"}}class BpmnApiResources{static instance;config={};constructor(e){this.config=e}static getInstance(e){return null==this.instance&&(this.instance=new BpmnApiResources(e)),this.instance}getConfig(){return this.config}deployment(){return DeploymentService.getInstance(this.config)}processDefinition(){return ProcessDefinitionService.getInstance(this.config)}processInstance(){return ProcessInstanceService.getInstance(this.config)}task(){return TaskService.getInstance(this.config)}historyActivityInstance(){return HistoryActivityInstanceService.getInstance(this.config)}historyProcessInstance(){return HistoryProcessInstanceService.getInstance(this.config)}historyTask(){return HistoryTaskService.getInstance(this.config)}group(){return GroupService.getInstance(this.config)}groupMember(){return GroupMemberService.getInstance(this.config)}tenant(){return TenantService.getInstance(this.config)}tenantUser(){return TenantUserService.getInstance(this.config)}tenantGroup(){return TenantGroupService.getInstance(this.config)}user(){return UserService.getInstance(this.config)}}Object.defineProperty(e,"Axios",{enumerable:!0,get:()=>t.Axios}),Object.defineProperty(e,"ContentTypeEnum",{enumerable:!0,get:()=>t.ContentTypeEnum}),Object.defineProperty(e,"HttpConfig",{enumerable:!0,get:()=>t.HttpConfig}),Object.defineProperty(e,"Service",{enumerable:!0,get:()=>t.Service}),Object.defineProperty(e,"lodash",{enumerable:!0,get:()=>t.lodash}),Object.defineProperty(e,"moment",{enumerable:!0,get:()=>t.moment}),e.BaseBpmnService=BaseBpmnService,e.BpmnQueryByGetService=BpmnQueryByGetService,e.BpmnQueryByPostService=BpmnQueryByPostService,e.BpmnQueryService=BpmnQueryService,e.BpmnService=BpmnService,e.DeploymentService=DeploymentService,e.GroupMemberService=GroupMemberService,e.GroupService=GroupService,e.HistoryActivityInstanceService=HistoryActivityInstanceService,e.HistoryProcessInstanceService=HistoryProcessInstanceService,e.HistoryTaskService=HistoryTaskService,e.ProcessDefinitionService=ProcessDefinitionService,e.ProcessInstanceService=ProcessInstanceService,e.RelationPathParamBuilder=RelationPathParamBuilder,e.TaskService=TaskService,e.TenantGroupService=TenantGroupService,e.TenantService=TenantService,e.TenantUserService=TenantUserService,e.UnionPathParamBuilder=UnionPathParamBuilder,e.UserService=UserService,e.createBpmnApi=(e,s,r,n)=>{const i=new t.HttpConfig(e,s,r,n);return BpmnApiResources.getInstance(i)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
