!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@herodotus/core")):"function"==typeof define&&define.amd?define(["exports","@herodotus/core"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["@herodotus/bpmn-apis"]={},e.HerodotusCore)}(this,function(e,t){"use strict";var s=Object.defineProperty,r=(e,t,r)=>((e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class PathParamBuilder{constructor(e){r(this,"address"),r(this,"action",""),this.address=e}getWellFormedAddress(){let e=this.address;return t.lodash.endsWith(e,"/")?t.lodash.trimEnd(e,"/"):e}addAction(e){this.action=e}appendAction(e){return this.action?e+"/"+this.action:e}}class UnionPathParamBuilder extends PathParamBuilder{constructor(e){super(e),r(this,"id",""),r(this,"key",""),r(this,"tenantId","")}setAction(e){return this.addAction(e),this}withParam(e){return this.id=e.id,this.key=e.key,this.tenantId=e.tenantId,this}build(){let e=this.getWellFormedAddress();return this.id?e+="/"+this.id:(this.key&&(e+="/key/"+this.key),this.tenantId&&(e+="/tenant-id/"+this.tenantId)),this.appendAction(e)}}class RelationPathParamBuilder extends PathParamBuilder{constructor(e){super(e),r(this,"id",""),r(this,"relationId","")}withParam(e){return this.id=e.id,this.relationId=e.relationId,this.addAction(e.action),this}build(){let e=this.getWellFormedAddress();return e+="/"+this.id,e=this.appendAction(e),e+="/"+this.relationId,e}}class BpmnService extends t.Service{getCountAddress(){return this.getBaseAddress()+"/count"}createAddressByParam(e,t=""){let s=new UnionPathParamBuilder(this.getBaseAddress());return t?s.withParam(e).setAction(t).build():s.withParam(e).build()}createAddressByRelation(e,t,s){return new RelationPathParamBuilder(this.getBaseAddress()).withParam({id:e,relationId:t,action:s}).build()}createAddressById(e,t=""){return this.createAddressByParam({id:e},t)}delete(e,s={}){return t.lodash.isEmpty(s)?this.getConfig().getHttp().delete(this.createAddressById(e)):this.getConfig().getHttp().deleteWithParams(this.createAddressById(e),s)}}class BpmnQueryByGetService extends BpmnService{getCount(e={}){return new Promise((t,s)=>{this.getConfig().getHttp().get(this.getCountAddress(),e).then(e=>{if(e){t(e.count)}}).catch(e=>{s(e)})})}getList(e,t,s={}){const r=Object.assign(s,{sortBy:e.sortBy,sortOrder:e.sortOrder,firstResult:(e.pageNumber-1)*e.pageSize,maxResults:e.pageSize});return new Promise((s,n)=>{this.getConfig().getHttp().get(this.getBaseAddress(),r).then(r=>{const n={content:r,totalPages:t?(t+e.pageSize-1)/e.pageSize:t,totalElements:String(t)};s(n)}).catch(e=>{n(e)})})}getByPage(e,t={}){return new Promise((s,r)=>{this.getCount(t).then(r=>{this.getList(e,r,t).then(e=>{s(e)})}).catch(e=>{r(e)})})}getAll(e,t={}){return new Promise((s,r)=>{this.getCount(t).then(r=>{const n=Object.assign(t,{sortBy:e.sortBy,sortOrder:e.sortOrder,firstResult:0,maxResults:r});this.getConfig().getHttp().get(this.getBaseAddress(),n).then(e=>{s(e)})}).catch(e=>{r(e)})})}}class BpmnQueryService extends BpmnQueryByGetService{get(e){return this.getConfig().getHttp().get(this.createAddressById(e))}}class BpmnQueryByPostService extends BpmnQueryService{getPostCount(e={}){return new Promise((t,s)=>{this.getConfig().getHttp().get(this.getCountAddress(),e).then(e=>{if(e){t(e.count)}}).catch(e=>{s(e)})})}getPostList(e,s,r=[],n={}){const i={firstResult:(e.pageNumber-1)*e.pageSize,maxResults:e.pageSize};let a={};return t.lodash.isEmpty(r)||(a=Object.assign(n,{sorting:r})),new Promise((t,r)=>{this.getConfig().getHttp().postWithParams(this.getBaseAddress(),i,a).then(r=>{const n={content:r,totalPages:s?(s+e.pageSize-1)/e.pageSize:s,totalElements:String(s)};t(n)}).catch(e=>{r(e)})})}getPostByPage(e,t=[],s={}){return new Promise((r,n)=>{this.getPostCount(s).then(n=>{this.getPostList(e,n,t,s).then(e=>{r(e)})}).catch(e=>{n(e)})})}}class BaseBpmnService extends BpmnQueryByPostService{}const n=class _DeploymentService extends BpmnQueryService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _DeploymentService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/deployment"}getCreateAddress(){return this.getBaseAddress()+"/create"}getDuplicateFiltering(e){return e.deployChangedOnly?"true":e.enableDuplicateFiltering?String(e.enableDuplicateFiltering):"false"}create(e){let s=new FormData;s.append("deployment-name",e.deploymentName),s.append("deploy-changed-only",e.deployChangedOnly?"true":"false"),s.append("enable-duplicate-filtering",this.getDuplicateFiltering(e)),s.append("deployment-source",e.deploymentSource?e.deploymentSource:"Dante Cloud UI");const r=e.deploymentActivationTime?e.deploymentActivationTime:new Date;s.append("deployment-activation-time",t.moment(r).utc().format()),e.tenantId&&s.append("tenant-id",e.tenantId);let n=new Blob([e.resource],{type:"application/octet-stream"});return s.append("data",n,e.deploymentName),this.getConfig().getHttp().post(this.getCreateAddress(),s,{contentType:t.ContentTypeEnum.MULTI_PART})}redeploy(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"redeploy"),t)}getResources(e){return this.getConfig().getHttp().get(this.createAddressById(e,"resources"))}getResource(e,t){return this.getConfig().getHttp().get(this.createAddressByRelation(e,t,"resources"))}getBinaryResource(e,t){const s=this.createAddressByRelation(e,t,"resources")+"/data";return this.getConfig().getHttp().get(s)}getRegisteredDeployments(){const e=this.getBaseAddress()+"/registered";return this.getConfig().getHttp().get(e)}};r(n,"instance");let i=n;const a=class _ProcessDefinitionService extends BpmnQueryService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _ProcessDefinitionService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/process-definition"}getActivityInstanceStatistics(e,t){return this.getConfig().getHttp().get(this.createAddressByParam(e,"statistics"),t)}getStaticCalledProcessDefinitions(e){return this.getConfig().getHttp().get(this.createAddressById(e,"static-called-process-definitions"))}getDiagram(e){return this.getConfig().getHttp().get(this.createAddressByParam(e,"diagram"))}getStartFormVariables(e,t){return this.getConfig().getHttp().get(this.createAddressByParam(e,"form-variables"),t)}getRenderedFormStartForm(e){return this.getConfig().getHttp().get(this.createAddressByParam(e,"rendered-form"))}getStartFormKey(e){return this.getConfig().getHttp().get(this.createAddressByParam(e,"startForm"))}getProcessInstanceStatistics(e){const t=this.getBaseAddress()+"/statistics";return this.getConfig().getHttp().get(t,e)}getXml(e){return this.getConfig().getHttp().get(this.createAddressByParam(e,"xml"))}getByPathParams(e){return this.getConfig().getHttp().get(this.createAddressByParam(e))}start(e,t){return this.getConfig().getHttp().post(this.createAddressByParam(e,"start"),t)}submitStartForm(e,t){return this.getConfig().getHttp().post(this.createAddressByParam(e,"submit-form"),t)}activateOrSuspendById(e,t){return this.getConfig().getHttp().put(this.createAddressByParam(e,"suspended"),t)}activateOrSuspendByKey(e){const t=this.getBaseAddress()+"/suspended";return this.getConfig().getHttp().put(t,e)}updateHistoryTimeToLive(e,t){return this.getConfig().getHttp().put(this.createAddressByParam(e,"history-time-to-live"),t)}deleteByKey(e,t="",s){return this.getConfig().getHttp().deleteWithParams(this.createAddressByParam({key:e,tenantId:t},"delete"),s)}getDeployedStartForm(e){return this.getConfig().getHttp().get(this.createAddressByParam(e,"deployed-start-form"))}restartProcessInstance(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"restart"),t)}restartAsync(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"restart-async"),t)}};r(a,"instance");let c=a;const o=class _ProcessInstanceService extends BaseBpmnService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _ProcessInstanceService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/process-instance"}getActivityInstance(e){return this.getConfig().getHttp().get(this.createAddressById(e,"activity-instances"))}modify(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"modification"),t)}modifyAsync(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"modification-async"),t)}deleteAsync(e){const t=this.getBaseAddress()+"/delete";return this.getConfig().getHttp().post(t,e)}deleteAsyncHistoricQueryBased(e){const t=this.getBaseAddress()+"/delete-historic-query-based";return this.getConfig().getHttp().post(t,e)}setJobRetriesAsync(e){const t=this.getBaseAddress()+"/job-retries";return this.getConfig().getHttp().post(t,e)}setJobRetriesAsyncHistoricQueryBased(e){const t=this.getBaseAddress()+"/job-retries-historic-query-based";return this.getConfig().getHttp().post(t,e)}setVariablesAsync(e){const t=this.getBaseAddress()+"variables-async";return this.getConfig().getHttp().post(t,e)}correlateMessageAsync(e){const t=this.getBaseAddress()+"message-async";return this.getConfig().getHttp().post(t,e)}activateOrSuspendById(e,t){return this.getConfig().getHttp().put(this.createAddressById(e,"suspended"),t)}activateOrSuspendByProcessDefinitionId(e){const t=this.getBaseAddress()+"/suspended";return this.getConfig().getHttp().put(t,e)}activateOrSuspendByProcessDefinitionKey(e){const t=this.getBaseAddress()+"/suspended";return this.getConfig().getHttp().put(t,e)}activateOrSuspendInGroup(e){const t=this.getBaseAddress()+"suspended-async";return this.getConfig().getHttp().post(t,e)}activateOrSuspendInBatch(e){const t=this.getBaseAddress()+"suspended-async";return this.getConfig().getHttp().post(t,e)}};r(o,"instance");let g=o;const d=class _TaskService extends BaseBpmnService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _TaskService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/task"}getCreateAddress(){return this.getBaseAddress()+"/create"}getFormKey(e){return this.getConfig().getHttp().get(this.createAddressById(e,"form"))}claim(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"claim"),t)}unclaim(e){return this.getConfig().getHttp().post(this.createAddressById(e,"unclaim"),{})}complete(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"complete"),t)}submitForm(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"submit-form"),t)}resolve(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"resolve"),t)}setAssignee(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"assignee"),t)}delegate(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"delegate"),t)}getDeployedForm(e){return this.getConfig().getHttp().get(this.createAddressById(e,"deployed-form"))}getRenderedForm(e){return this.getConfig().getHttp().get(this.createAddressById(e,"rendered-form"))}getTaskFormVariables(e,t){return this.getConfig().getHttp().get(this.createAddressById(e,"form-variables"),t)}create(e){return this.getConfig().getHttp().post(this.getCreateAddress(),e)}update(e,t){return this.getConfig().getHttp().put(this.createAddressById(e),t)}handleBpmnError(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"bpmnError"),t)}handleBpmnEscalation(e,t){return this.getConfig().getHttp().post(this.createAddressById(e,"bpmnEscalation"),t)}};r(d,"instance");let u=d;const h=class _HistoryActivityInstanceService extends BpmnQueryByPostService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _HistoryActivityInstanceService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/history/activity-instance"}};r(h,"instance");let p=h;const l=class _HistoryProcessInstanceService extends BpmnQueryByPostService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _HistoryProcessInstanceService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/history/process-instance"}};r(l,"instance");let m=l;const y=class _HistoryTaskService extends BpmnQueryByPostService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _HistoryTaskService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/history/task"}};r(y,"instance");let B=y;const f=class _GroupService extends BaseBpmnService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _GroupService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/group"}getCreateAddress(){return this.getBaseAddress()+"/create"}create(e){return this.getConfig().getHttp().post(this.getCreateAddress(),e)}update(e,t){return this.getConfig().getHttp().put(this.createAddressById(e),t)}};r(f,"instance");let A=f;const C=class _GroupMemberService extends BpmnService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _GroupMemberService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/group"}getRelationAddress(e,t=""){return this.createAddressByRelation(e,t,"members")}create(e,t){return this.getConfig().getHttp().put(this.getRelationAddress(e,t),"")}deleteByRelation(e,t){return this.getConfig().getHttp().delete(this.getRelationAddress(e,t))}};r(C,"instance");let S=C;const v=class _TenantService extends BpmnQueryService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _TenantService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/tenant"}getCreateAddress(){return this.getBaseAddress()+"/create"}createTenant(e){return this.getConfig().getHttp().post(this.getCreateAddress(),e)}update(e,t){return this.getConfig().getHttp().put(this.createAddressById(e),t)}};r(v,"instance");let P=v;const I=class _TenantUserService extends BpmnService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _TenantUserService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/tenant"}getRelationAddress(e,t=""){return this.createAddressByRelation(e,t,"user-members")}create(e,t){return this.getConfig().getHttp().put(this.getRelationAddress(e,t),"")}deleteByRelation(e,t){return this.getConfig().getHttp().delete(this.getRelationAddress(e,t))}};r(I,"instance");let H=I;const b=class _TenantGroupService extends BpmnService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _TenantGroupService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/tenant"}getRelationAddress(e,t=""){return this.createAddressByRelation(e,t,"group-members")}create(e,t){return this.getConfig().getHttp().put(this.getRelationAddress(e,t),"")}deleteByRelation(e,t){return this.getConfig().getHttp().delete(this.getRelationAddress(e,t))}};r(b,"instance");let R=b;const w=class _UserService extends BpmnQueryByGetService{constructor(e){super(e)}static getInstance(e){return null==this.instance&&(this.instance=new _UserService(e)),this.instance}getBaseAddress(){return this.getConfig().getBpmn()+"/user"}getCreateAddress(){return this.getBaseAddress()+"/create"}};r(w,"instance");let T=w;const x=class _BpmnApiResources{constructor(e){r(this,"config",{}),this.config=e}static getInstance(e){return null==this.instance&&(this.instance=new _BpmnApiResources(e)),this.instance}getConfig(){return this.config}deployment(){return i.getInstance(this.config)}processDefinition(){return c.getInstance(this.config)}processInstance(){return g.getInstance(this.config)}task(){return u.getInstance(this.config)}historyActivityInstance(){return p.getInstance(this.config)}historyProcessInstance(){return m.getInstance(this.config)}historyTask(){return B.getInstance(this.config)}group(){return A.getInstance(this.config)}groupMember(){return S.getInstance(this.config)}tenant(){return P.getInstance(this.config)}tenantUser(){return H.getInstance(this.config)}tenantGroup(){return R.getInstance(this.config)}user(){return T.getInstance(this.config)}};r(x,"instance");let _=x;Object.defineProperty(e,"Axios",{enumerable:!0,get:()=>t.Axios}),Object.defineProperty(e,"ContentTypeEnum",{enumerable:!0,get:()=>t.ContentTypeEnum}),Object.defineProperty(e,"HttpConfig",{enumerable:!0,get:()=>t.HttpConfig}),Object.defineProperty(e,"Service",{enumerable:!0,get:()=>t.Service}),Object.defineProperty(e,"lodash",{enumerable:!0,get:()=>t.lodash}),Object.defineProperty(e,"moment",{enumerable:!0,get:()=>t.moment}),e.BaseBpmnService=BaseBpmnService,e.BpmnQueryByGetService=BpmnQueryByGetService,e.BpmnQueryByPostService=BpmnQueryByPostService,e.BpmnQueryService=BpmnQueryService,e.BpmnService=BpmnService,e.DeploymentService=i,e.GroupMemberService=S,e.GroupService=A,e.HistoryActivityInstanceService=p,e.HistoryProcessInstanceService=m,e.HistoryTaskService=B,e.ProcessDefinitionService=c,e.ProcessInstanceService=g,e.RelationPathParamBuilder=RelationPathParamBuilder,e.TaskService=u,e.TenantGroupService=R,e.TenantService=P,e.TenantUserService=H,e.UnionPathParamBuilder=UnionPathParamBuilder,e.UserService=T,e.createBpmnApi=(e,s,r,n)=>{const i=new t.HttpConfig(e,s,r,n);return _.getInstance(i)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});
